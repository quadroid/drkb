<!DOCTYPE html>
<html>
<head>
  <title>Соответствие стандарту ANSI SQL 92</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <link type="text/css" href="css/css.css" rel="stylesheet"/>
  <link type="text/css" href="css/sh.css" rel="stylesheet"/>
  <script language="javascript" src="js/shInit.js"></script>
  <script language="javascript" src="js/shCore.js"></script>
  <script language="javascript" src="js/shBrushDelphi.js"></script>
  <script language="javascript" src="js/shBrushSql.js"></script>
</head>
<body>
<div id="layout">
<div id="header">
  <a title="DRKB Library" href="../splash.html"><div id="logo"></div></a>
</div>
<div id="content">
<div id="explorer">DRKB Explorer</div>
  <h1 id="title">Соответствие стандарту ANSI SQL 92</h1>
<div id="date">01.01.2010</div>

Соответствие стандарту ANSI SQL 92</p>
<p>В MS SQL Server имеются настройки, позволяющие изменять степень соответствия сервера стандарту ANSI SQL 92.</p>
<p>SET ANSI_NULLS {ON|OFF} &#8211; регулирует результат сравнения значений, содержащих NULL. Если ANSI_NULLS = OFF, то запрос</p>
<pre name="code" class="sql">
SELECT * FROM MyTable WHERE MyField = NULL
</pre>

<p>Вернет все строки, в которых MyField установлено в NULL. Если ANSI_NULLS = OFF, то, в соответствии со стандартом ANSI SQL92 сравнение с NULL возвращает UNKNOWN. Другие установки, на которые следует обратить внимание:</p>
<p>SET CURSOR_CLOSE_ON_COMMIT &mdash; Устанавливает режим закрытия курсоров по завершению транзакции &nbsp; &nbsp; &nbsp; </p>
<p>SET ANSI_NULL_DFLT_ON и&nbsp; SET ANSI_NULL_DFLT_OFF &mdash; Устанавливают nullability полей по умолчанию при создании таблицы &nbsp; &nbsp; &nbsp; </p>
<p>SET IMPLICIT_TRANSACTIONS &mdash; Устанавливает режим Autocommit &nbsp; &nbsp; &nbsp; </p>
<p>SET ANSI_PADDING &mdash; Устанавливает режим «отсечения» концевых пробелов для вновь создаваемых полей &nbsp; &nbsp; &nbsp; </p>
<p>SET QUOTED_IDENTIFIER &mdash; Разрешает выделение идентификаторов двойными кавычками &nbsp; &nbsp; &nbsp; </p>
<p>SET ANSI_WARNINGS &mdash; Устанавливает реакцию на математические ошибки &nbsp; &nbsp; &nbsp; </p>
<p>Рассмотрение этих параметров выходит за рамки книги, однако необходимо обратить на них внимание при чтении документации.</p>
<p>Установка SET ANSI_DEFAULTS устанавливает режим максимальной совместимости с ANSI SQL92. При установке SET ANSI_DEFAULTS ON устанавливаются в ON следующие параметры:</p>
<p>SET ANSI_NULLS, SET CURSOR_CLOSE_ON_COMMIT, SET ANSI_NULL_DFLT_ON, SET IMPLICIT_TRANSACTIONS, SET ANSI_PADDING, SET QUOTED_IDENTIFIER и SET ANSI_WARNINGS</p>
<p>По умолчанию ANSI_DEFAULTS = ON для клиентов ODBC и OLE DB (ADO) и OFF для клиента DB-Library (BDE). Поскольку предпочтительным (и поддерживаемым в будущем) методом доступа является OLE DB, то при разработке клиентской части, использующей BDE, рекомендуется явно устанавливать SET ANSI_DEFAULTS ON. С разностью этой установки связана и проблема, возникающая при разработке запросов при помощи Query Analyzer. Если в нем и в клиентском приложении имеются разные настройки совместимости с ANSI &#8211; одни и те же запросы могут выдавать разные результаты. Поэтому рекомендуется проверять настройки Query Analyzer на предмет соответствия их тем, что предполагается иметь в клиенте.</p>
</div>

<div id="footer">
<hr/>
<p>Материал из DRKB Library<br/>Разработка и поддержка &mdash; <a title="DRKB на GitHub" href="https://github.com/quadroid/drkb" target="_blank">Quadr0</a></p>
</div>
</div>
</body>
</html>
