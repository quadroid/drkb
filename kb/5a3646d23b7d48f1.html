<!DOCTYPE html>
<html>
<head>
  <title>Описание протокола DNS</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <link type="text/css" href="css/css.css" rel="stylesheet"/>
  <link type="text/css" href="css/sh.css" rel="stylesheet"/>
  <script language="javascript" src="js/shInit.js"></script>
  <script language="javascript" src="js/shCore.js"></script>
  <script language="javascript" src="js/shBrushDelphi.js"></script>
  <script language="javascript" src="js/shBrushSql.js"></script>
</head>
<body>
<div id="layout">
<div id="header">
  <a title="DRKB Library" href="../splash.html"><div id="logo"></div></a>
</div>
<div id="content">
<div id="explorer">DRKB Explorer</div>
  <h1 id="title">Описание протокола DNS</h1>
<div id="date">01.01.2010</div>

<p>Служба Доменных Имен предназначена для того, чтобы машины, работающие в Internet, могли по доменному имени узнать IP-адрес нужной им машины, а также некоторую другую информацию; а по IP-номеру могли узнать доменное имя машины. </p>
<p>Служба Доменных Имен была разработана для именования машин в глобальной сети. Основной особенностью глобальной сети является распределенное администрирование, когда один администратор физически не может уследить за выделением имен. Поэтому Служба Доменных Имен функционирует на принципе делегирования полномочий. Каждая машина либо знает ответ на вопрос, либо знает кого спросить. При правильном функционировании система замкнута, т.е. если запрошенная информация имеется у кого-либо, то она будет найдена и сообщена клиенту, либо, если вопрос не имеет ответа, клиент получит сообщение о невозможности получения ответа на вопрос. </p>
<p>Каждый клиент знает своего сервера; обычно указывается не один, а несколько серверов - если первый не отвечает, клиент обращается ко второму и так далее до исчерпания списка. В принципе неважно, к какому серверу обращаться - они дают (должны давать при правильном функционировании) одинаковые ответы на любой запрос. Поэтому для ускорения работы обычно указывают ближайший. Следует помнить, что на одной машине могут функционировать одновременно Name-сервер и программы-клиенты; поэтому если на машине запущен Name-сервер, то в качестве Name-сервера на ней должен быть прописан "я сам". </p>
<p>Имеется некий домен верхнего уровня, обозначаемый точкой: ".". Имеется девять серверов (по крайней мере на моем Name-сервере записано столько), которые отвечают за эту зону. Они не знают ни одного доменного имени - они только авторизуют серверы верхних зон. Серверы верхних зон тоже гнушаются хранить информацию о конкретных машинах и передают это право нижележащим серверам. Тут уже появляются первые упоминания о конкретных машинах, равно как и происходит авторизация нижележащих серверов. </p>
<p>Мне неизвестна ни одна машина с доменным именем из одного сегмента; очень редко используются доменные имена из двух сегментов; имена из трех и четырех сегментов составляют подавляющую долю всех имен Internet; имена из пяти сегментов встречаются довольно редко, а из шести и более мне неизвестны. </p>
<p>Допустим, клиент запросил адрес "www.организация.город.страна". Поиск информации по доменному имени происходит следующим образом: </p>
<p>Клиент спрашивает своего сервера. </p>
<p>Если тот является сервером данной зоны, то ответит, на чем все заканчивается. </p>
<p>Сервер спрашивает корневой сервер. </p>
<p>Тот не может ответить, потому что не знает; зато знает, какой сервер отвечают за зону "страна". </p>
<p>Сервер зоны "страна" тоже не может ответить, но знает, что нужно спросить сервер зоны "город.страна". </p>
<p>Тот в свою очередь отсылает запрос серверу зоны "организация.город.страна", который сообщит нужную информацию. </p>
<p>Это приближенная модель, которая тем не менее позволяет представить работу системы DNS. </p>
<p>Однако эту стройную картину искажают системы кэширования и вторичных серверов. Дело в том, что получив ответ на свой вопрос, DNS-сервер получает также некоторое число, которое говорит ему о том, по истечении какого времени эта информация должна считаться устаревшей. Таким образом, все серверы, участвовавшие в поиске ответа на вопрос, заданный клиентом, могут (и скорее всего будут) помнить как ответ на заданный вопрос, так и путь, по которому шел поиск. При следующих запросах, имеющих общую правую часть с недавно сделанными запросами, поиск будет упрощен (ускорен). </p>
<p>Кроме того, большинство зон имеет вторичные серверы, которые содержат копии данных с первичных серверов. Сервер вышележащей зоны может направить запрос как первичному серверу, так и любому из вторичных, основываясь на своих соображениях о том, какой из них ближе. </p>
<p>Хочу обратить особое внимание на сходство, различие и взаимодействие систем DNS и IP-маршрутизации. Как и IP-маршрутизация, DNS работает по принципу делегирования полномочий, но выделение доменных имен совершенно не зависит от выделения IP-адресов. Для примера рассмотрим домен freebsd.org. Это - домен организации, занимающейся распространением операционной системы FreeBSD Unix. FTP-сервер, содержащий дистрибутив операционной системы и множества утилит для нее, имеет копии в нескольких десятках стран. Имена серверов выглядят так: </p>
<p>ftp.freebsd.org </p>
<p>первичный сервер в США </p>
<p>ftp.страна.freebsd.org </p>
<p>основной сервер в стране </p>
<p>ftpчисло.страна.freebsd.org </p>
<p>дополнительный сервер в стране </p>
<p>Так например на 11 февраля 1998 года</p>
<p>ftp.ru.freebsd.org соответствует ftp.ru </p>
<p>ftp2.ru.freebsd.org соответствует ftp.gamma.ru </p>
<p>ftp3.ru.freebsd.org соответствует ftp.chg.ru </p>
<p>Таким образом, машины, находящиеся в России оказались произвольно (по воле DNS-мастера из университета Bercley) включенными в домен freebsd.org; однако, они также состоят в своих зонах. Система DNS позволяет любому DNS-мастеру включить любой сервер в свою зону, хотя это включение никого ни к чему не обязывает. </p>
<p>Однако, некоторым сервисам этого недостаточно - так E-mail требует, чтобы машина, принимающая письмо, признала своим адрес, указанный в качестве пункта назначения. Протокол HTTP 1.1 (в 1.0 этого не было) требует, чтобы в HTTP-запросе указывался не путь к файлу, отсчитанный от корня сервера (хотя такие запросы тоже признаются), но и имя сервера; при этом сам сервер знает, какие имена - его, а остальные обрезает и обслуживает в соответствии с HTTP 1.0. </p>
<p>Делегирование зоны ...in-addr.arpa дается только от провайдера вместе с IP-адресами. Собственно, это связано с предназначением ReverceDNS - сообщать доменное имя по IP-адресу. Наверняка мастер зоны freebsd.org держит Reverce-зону для IP-номеров, выделенных университету Bercley; но все эти серверы (кроме сервера, расположенного в университете) не входят в эту Reverce-зону, а значит, ему неподконтрольны. </p>
<p>Одна из проблем состит в том, что Reverce-зону можно выделить только на сеть класса A, B или C (на 16777216, 65536 или 256 адресов) и никак иначе. Можно получить правА на несколько зон одного или разных классов, но что делать тем, кому выделили меньше 256 адресов? А ведь в условиях исчерпания адресного пространства не редкость выделения пула уже на 16 адресов! </p>
<p>DNS-услуги Internet-провайдера </p>
<p>Как правило, провайдер предоставляет клиенту целый комплекс услуг. В число оказываемых DNS-услуг входят: </p>
<p>делегирование зоны ...in-addr.arpa клиентам, имеющим пул адресов, кратный 256. </p>
<p>регистрация доменного имени клиента у держателя той зоны, в которой клиент хочет зарегистрироваться; </p>
<p>поддержание вторичного сервера прямой и обратной DNS-зон клиента; </p>
<p>поддержание первичного сервера этих зон, если клиент по какой-либо причине не поддерживает их сам (особенно это относится к случаю виртуальных зон и к случаю выделения малого пула адресов); </p>
<p>Если провайдер будет отказываться - сошлитесь на меня. :-) </p>
<p>Политика и стратегия назначения имен </p>
<p>Имена зон условно можно разделить на "организационные" и "географические". В высшей зоне зарегестрированы следующие "организационные" зоны: </p>
<p>com commercial (коммерческие) </p>
<p>edu educational (образовательные) </p>
<p>gov goverment (правительственные) </p>
<p>mil military (военные) </p>
<p>net network (организации, обеспечивающие работу сети) </p>
<p>org organization (некоммерческие организации) </p>
<p>В данный момент, чтобы разгрузить домен com, собираются создать несколько новых доменов, но у меня нет достоверной информации по ним. В организационных зонах обычно размещаются непосредственно домены организаций. </p>
<p>Каждая страна (государство) имеет свой географический домен из двух букв: </p>
<p>ae United Arab Emirates (Объединенные Арабские Эмираты) </p>
<p>au Australia (Австралия) </p>
<p>be Belgium (Бельгия) </p>
<p>br Brazil (Бразилия) </p>
<p>by Belarus (Белоруссия) </p>
<p>ca Canada (Канада) </p>
<p>ch Switzerland (Швейцария) </p>
<p>cz Czech Republic (Чехия) </p>
<p>de Germany (Германия) </p>
<p>dk Denmark </p>
<p>do Dominican Republic (Доминиканская республика) </p>
<p>ee Estonia (Эстония) </p>
<p>eo ??? </p>
<p>es Spain (Испания) </p>
<p>fi Finland (Финляндия) </p>
<p>fr France (Франция) </p>
<p>hu Hungary (Венгрия) </p>
<p>il Israel (Израиль) </p>
<p>in India (Индия) </p>
<p>iz ??? </p>
<p>jp Japan (Япония) </p>
<p>kg Kyrgyzstan (Кыргызстан) </p>
<p>kr South Korea (Южная Корея) </p>
<p>kz Kazakhstan (Казахстан) </p>
<p>lt Lithuania (Литва) </p>
<p>lv Latvia (Латвия) </p>
<p>mx Mexico (Мексика) </p>
<p>nl Netherlands (Нидерланды) </p>
<p>no Norway (Норвегия) </p>
<p>nz New Zealand (Новая Зеландия) </p>
<p>pl Poland (Польша) </p>
<p>ro Romania (Румыния) </p>
<p>ru Russia (Россия) </p>
<p>si Slovenia (Словения) </p>
<p>sk Slovak Republic (Словакия) </p>
<p>su Soviet Union (Советский Союз - поддерживается, но не распределяется) </p>
<p>ua Ukraine (Украина) </p>
<p>uk United Kingdom (Соединенное Королевство ВеликоБритания / Англия) </p>
<p>yu Yugoslavia (Югославия) </p>
<p>za South Africa (Южная Африка) </p>
<p>Я перечислил отнюдь не все страны - кто хочет, может прислать мне другие названия. </p>
<p>В зонах государств опять же имеются "организационные" и "географические" зоны. "Организационные" в большинстве своем повторяют структуру "организационных" зон верхнего уровня, разве что вместо "com" используется "co". "Географические" выделяются городам, областям и т.п. территориальным образованиям. Непосредственно в тех и других размещаются домены организаций или домены персональных пользователей. </p>
<p>После выбора зоны, в которую будет включен наш домен надо выбрать собственное имя домена. Обычно это имя компании, торговая марка или что-нибудь столь же характерное. Для неанглоязычных стран используется транскрипция имен. Часто возникают конфликты, связанные с тем, что одно и то же имя используется несколькими фирмами (законодательство допускает это для фирм, работающих в разных отраслях); многие люди заранее резервируют имена, могущие стать популярными для последующей продажи их владельцу торговой марки; но это уже касается юридической стороны функционирования Internet и не входит в мою компетенцию. </p>
<p>С левого конца доменного имени находятся имена машин. Имена бывают "собственные" и "функциональные". Имена "собственные" каждый придумавает в меру фантазии: машинам присваиваются имена членов семьи, животных, растений, музыкантов и артистов, литературных персонажей - кто во что горазд. </p>
<p>Имена "функциональные" вытекают из функций, выполняемых машиной: </p>
<p>www </p>
<p>HTTP (WWW) сервер </p>
<p>ftp </p>
<p>FTP сервер </p>
<p>ns, nss, dns </p>
<p>DNS (Name) сервер </p>
<p>mail </p>
<p>Mail сервер </p>
<p>relay </p>
<p>Mail Exchanger </p>
<p>*proxy </p>
<p>соответствующий Proxy сервер </p>
<p>Я считаю нежелательным присваивать какой-либо машине функциональное имя - в любой момент может потребоваться перенести соответствующую функцию на другую машину. Для этого лучше всего использовать псевдонимы, которые перенаправляют запросы к данному имени на записи, относящиеся к другому имени. Но вот ссылаться на псевдонимы при обьявлении Mail Exchanger'ов и вообще использовать их в правой части записей считается нежелательным, а зачастую является недопустимым </p>
<p>Взято с <a href="http://delphiworld.narod.ru" target="_blank">http://delphiworld.narod.ru</a></p>
</div>

<div id="footer">
<hr/>
<p>Материал из DRKB Library<br/>Разработка и поддержка &mdash; <a title="DRKB на GitHub" href="https://github.com/quadroid/drkb" target="_blank">Quadr0</a></p>
</div>
</div>
</body>
</html>
