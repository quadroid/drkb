<!DOCTYPE html>
<html>
<head>
  <title>Протокол TCP</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <link type="text/css" href="css/css.css" rel="stylesheet"/>
  <link type="text/css" href="css/sh.css" rel="stylesheet"/>
  <script language="javascript" src="js/shInit.js"></script>
  <script language="javascript" src="js/shCore.js"></script>
  <script language="javascript" src="js/shBrushDelphi.js"></script>
  <script language="javascript" src="js/shBrushSql.js"></script>
</head>
<body>
<div id="layout">
<div id="header">
  <a title="DRKB Library" href="../splash.html"><div id="logo"></div></a>
</div>
<div id="content">
<div id="explorer">DRKB Explorer</div>
  <h1 id="title">Протокол TCP</h1>
<div id="date">01.01.2010</div>
<p>Протокол TCP</p>
<p>Радик Усманов radik@binep.ac.ru </p>
<p>Оригинальная версия документа RFC793 размещается на сервере ISI (Information Sciences Institute ): </p>
<p> URL - <a href="http://info.internet.isi.edu/in-notes/rfc/files/rfc793.txt" target="_blank">http://info.internet.isi.edu/in-notes/rfc/files/rfc793.txt</a></p>
<p>Vit - в ДРКБ публикуется в сильно сокращённом варианте</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. Введение &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Протокол управления передачей (TCP) предназначен для использования </p>
<p>в качестве надежного протокола общения между хост-компьютерами в </p>
<p>коммуникационных компьютерных сетях с коммутацией пакетов, а также в </p>
<p>системах, объединяющих такие сети.</p>
<p>Данный документ описывает функции, которые должны выполняться прото- </p>
<p>колом управления передачей, программу, которая реализует протокол, а </p>
<p>также ее интерфейс с программами или пользователями, нуждающимися в </p>
<p>ее услугах.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.1 Мотивация &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p>Компьютерные коммуникационные системы играют все более важную роль в </p>
<p>военных, правительственных и гражданских приложениях. Этот документ в </p>
<p>первую очередь освещает требования к компьютерным коммуникациям в во- </p>
<p>енной области, и особенно к устойчивости в условиях недостаточной на- </p>
<p>дежности коммуникаций и возможности перегрузок. Тем не менее, многие </p>
<p>из этих проблем имеют место также в гражданском и правительственном </p>
<p>секторе.</p>
<p>В условиях, когда стратегические и тактические сети компьютерных ком- </p>
<p>муникаций возникают и исчезают, важно обеспечить средства для их со- </p>
<p>единения, а также стандартные протоколы коммуникации между процесса- </p>
<p>ми, которые бы поддерживали большой диапазон прикладных программ. </p>
<p>Предвидя потребность в таких стандартах, Представительство Секретари- </p>
<p>ата Обороны по научно-исследовательским и опытно- конструкторским ра- </p>
<p>ботам предъявило протокол управления передачей (Transmission Control </p>
<p>Protocol - TCP), описанный здесь, на основе стандартизации DoD прото- </p>
<p>кола коммуникаций между процессами.</p>
<p>TCP - это протокол обеспечения надежности прямых соединений, создан- </p>
<p>ный для многоуровневой иерархии протоколов, поддерживающих межсетевые </p>
<p>приложения. Протокол TCP обеспечивает надежность коммуникаций между </p>
<p>парами процессов на хост-компьютерах, включенных в различные ком- </p>
<p>пьютерные коммуникационные сети, которые объединены в единую систему. </p>
<p>В отношении надежности протоколов более низкого, чем TCP, уровня </p>
<p>сделаны весьма скромные запросы. TCP предполагает, что он может </p>
<p>получить простой, потенциально ненадежный сервис для своих датаграмм </p>
<p>со стороны протоколов нижнего уровня. В принципе, протокол TCP должен </p>
<p>быть работоспособен на большом наборе коммуникационных систем, </p>
<p>начиная с кабельных соединений и кончая сетями с переключением </p>
<p>пакетов или электрических цепей.</p>
<p>Протокол TCP основывается на концепциях, впервые описанных авторами </p>
<p>Cerf и Kahn в документе [1]. TCP занимает в многоуровневой архитек- </p>
<p>туре протоколов нишу непосредственно над протоколом Internet, который </p>
<p>позволяет протоколу TCP отправлять и получать сегменты информации пе- </p>
<p>ременной длины, заключенные в оболочку Internet датаграмм. Internet </p>
<p>датаграмма предоставляет средства для адресации отправителя и получа- </p>
<p>теля сегментов TCP в различных сетях. Протокол Internet также осу- </p>
<p>ществляет любую фрагментацию и сборку сегментов TCP, необходимую для </p>
<p>осуществления передачи и доставки через множество сетей и промежуточ- </p>
<p>ных шлюзов. Протокол Internet также обработывает информацию о приори- </p>
<p>тете, классификации безопасности, а также осуществляет разграничение </p>
<p>TCP сегментов. Так что данная информация может быть передана напрямую </p>
<p>через множество сетей.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Уровни протоколов &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------------------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; верхний уровень &nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------------------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TCP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------------------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; протокол Internet&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------------------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |коммуникационная сеть |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------------------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p>Большая часть этого документа написана всвязи с реализациями TCP про- </p>
<p>токола, которые вместе с протоколами более высокого уровня присут- </p>
<p>ствуют на хост-компьютере. Некоторые компьютерные системы будут вклю- </p>
<p>чаться в сети через главные компьютеры, содержащие протоколы уровней </p>
<p>TCP и Internet, а также специфическое сетевое программое обеспечение. </p>
<p>Спецификация TCP описывает ее интерфейс с протоколами более высокого </p>
<p>уровня, которые оказались осуществимы даже в случае главного компью- </p>
<p>тера, если реализован соответствующий протокол общения между хост- </p>
<p>компьютером и главным компьютером.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.2 Цель &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p>Протокол TCP обязан обеспечить надежный сервис для коммуникаций между </p>
<p>процессами в многосетевой системе. Протокол TCP должен быть общим </p>
<p>протоколом для коммуникаций между хост-компьютерами во множестве се- </p>
<p>тей.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.4 Интерфейсы &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p>Протокол TCP взаимодействует с одной стороны с пользователем или при- </p>
<p>кладной программой, а с другой - с протоколом более низкого уровня, </p>
<p>таким как протокол Internet.</p>
<p>Интерфейс между прикладным процессом и протоколом TCP мы поясняем с </p>
<p>приемлемой детализацией. Этот интерфейс состоит из набора вызовов, </p>
<p>которые похожи на вызовы операционной системы, предоставляемые при- </p>
<p>кладному процессу для управления файлами. Например, в этом случае </p>
<p>имеются вызовы для открытия и закрытия соединений, для отправки и по- </p>
<p>лучения данных на установленных соединениях. Предполагается также, </p>
<p>что протокол TCP сможет асинхронно взаимодействовать с прикладными </p>
<p>программами. Хотя разработчикам TCP протокола и предоставлена значи- </p>
<p>тельная свобода в создании интерфейсов, которые соответствуют свой- </p>
<p>ствам конкретной операционной системы, все же от любой приемлемой ре- </p>
<p>ализации требуются некие обязательные минимальные функции интерфейса </p>
<p>между протоколом TCP и пользователем. </p>
<p>Интерфейс между протоколом TCP и протоколами более низкого уровня за- </p>
<p>дан в значительно меньшей степени, за исключением того, что должен </p>
<p>существовать некий механизм, с помощью которого эти два уровня могут </p>
<p>асинхронно обмениваться информацией друг с другом. Обычно полагают, </p>
<p>что протокол нижнего уровня задает данный интерфейс. Протокол TCP </p>
<p>спроектирован так, чтобы работать с весьма разнообразной средой объ- </p>
<p>единенных компьютерных сетей. В данном документе предполагается, что </p>
<p>протокол более низкого уровня - это Internet [2].</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.5 Действие &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p>Как указывалось ранее, главной целью протокола TCP является обеспече- </p>
<p>ние надежного, безопасного сервиса для логических цепей или соедине- </p>
<p>ний между парами процессов. Чтобы обеспечить такой сервис, основыва- </p>
<p>ясь на менее надежных коммуникациях Internet, система должна иметь </p>
<p>возможности для работы в следующих областях:</p>
<p>- базовая передача данных</p>
<p>- достоверность</p>
<p>- управление потоком</p>
<p>- разделение каналов</p>
<p>- работа с соединениями</p>
<p>- приоритет и безопасность</p>
<p> &nbsp; Основные действия протокола TCP в каждой из этих областей описаны </p>
<p> &nbsp; в следующих параграфах.</p>
<p>Базовая передача данных</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Протокол TCP способен передавать непрерывные потоки октетов </p>
<p> &nbsp; между своими клиентами в обоих направлениях, пакуя некое количес- </p>
<p> &nbsp; тво октетов в сегменты для передачи через системы Internet. В об- </p>
<p> &nbsp; щем случае протоколы TCP решают по своему усмотрению, когда произ- </p>
<p> &nbsp; водить блокировку и передачу данных. </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Иногда пользователям бывает необходимо убедиться в том, что все </p>
<p> &nbsp; данные, переданные ими протоколу TCP, уже отправлены. Для этой це- </p>
<p> &nbsp; ли определена функция проталкивания (push). Чтобы убедиться в том, </p>
<p> &nbsp; что данные, отправленные протоколу TCP, действительно переданы, </p>
<p> &nbsp; отправитель указывает, что их следует протолкнуть к получателю. </p>
<p> &nbsp; Проталкивание приводит к тому, что программы протокола TCP сразу </p>
<p> &nbsp; осуществляют отправление и, соответственно, получение остающихся </p>
<p> &nbsp; данных. Правильно осуществленное проталкивание может быть невидимо </p>
<p> &nbsp; для получателя, а сама функция проталкивания может не иметь </p>
<p> &nbsp; маркера границы записи.</p>
<p>Достоверность</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Протокол TCP должен иметь защиту от разрушения данных, потери, </p>
<p> &nbsp; дублирования и нарушения очередности получения, вызываемых </p>
<p> &nbsp; коммуникационной системой Internet. Это достигается присвоением </p>
<p> &nbsp; очередного номера каждому передаваемому октету, а также </p>
<p> &nbsp; требованием подтверждения (ACK) от программы TCP, принимающей </p>
<p> &nbsp; данные. Если подтверждения не получено в течении контрольного </p>
<p> &nbsp; интервала времени, то данные посылаются повторно. Со стороны </p>
<p> &nbsp; получателя номера очереди используются для восстановления </p>
<p> &nbsp; очередности сегментов, которые могут быть получены в неправильном </p>
<p> &nbsp; порядке, а также для ограничения возможности появления дубликатов. </p>
<p> &nbsp; Повреждения фиксируются посредством добавления к каждому </p>
<p> &nbsp; передаваемому сегменту контрольной суммы, проверки ее при </p>
<p> &nbsp; получении и последующей ликвидации дефектных сегментов. </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; До тех пор, пока программы протокола TCP продолжают функциони- </p>
<p> &nbsp; ровать корректно, а система Internet не развалилась полностью на </p>
<p> &nbsp; составные части, ошибки пересылки не будут влиять на правильное </p>
<p> &nbsp; получение данных. Протокол TCP защищает от ошибок коммуникационной </p>
<p> &nbsp; системы Internet. </p>
<p>Управление потоком</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Протокол TCP дает средства получателю управлять количеством </p>
<p> &nbsp; данных, посылаемых ему отправителем. Это достигается возвратом так </p>
<p> &nbsp; называемого "окна" (window) вместе с каждым подтверждением, кото- </p>
<p> &nbsp; рое указывает диапазон приемлемых номеров, следующих за номером </p>
<p> &nbsp; последнего успешно принятого сегмента. Окно определяет количество </p>
<p> &nbsp; октетов, которое отправитель может послать до получения дальнейших </p>
<p> &nbsp; указаний. </p>
<p>Разделение каналов</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Чтобы позволить на отдельно взятом компьютере многим процессам </p>
<p> &nbsp; одновременно использовать коммуникационные возможности уровня TCP, </p>
<p> &nbsp; протокол TCP предоставляет на каждом хост-компьютере набор адресов </p>
<p> &nbsp; или портов. Вместе с адресами сетей и хост-компьютеров на коммни- </p>
<p> &nbsp; кационном уровне Internet они образуют сокет (socket - разъем). </p>
<p> &nbsp; Каждое соединение уникальным образом идентифицируется парой соке- </p>
<p> &nbsp; тов. Таким образом, любой сокет может одновременно использоваться </p>
<p> &nbsp; во многих соединениях.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Соотнесение портов и процесов осуществляется каждым хост- </p>
<p> &nbsp; компьютером самостоятельно. Однако оказывается полезным связывать </p>
<p> &nbsp; часто используемые процессы (такие как "logger" или сервис с раз- </p>
<p> &nbsp; делением времени) с фиксированными документированными сокетами. </p>
<p> &nbsp; Этот сервис можно впоследствии использовать через известные адре- </p>
<p> &nbsp; са. Установка и настройка адресов портов для других процессов мо- </p>
<p> &nbsp; жет включать более динамичные механизмы. </p>
<p>Работа с соединениями</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Механизмы управления потоком и обеспечения достоверности, опи- </p>
<p> &nbsp; санные выше, требуют, чтобы программы протокола TCP инициализиро- </p>
<p> &nbsp; вали и поддерживали определенную информацию о состоянии каждого </p>
<p> &nbsp; потока данных. Набор такой информации, включающий сокеты, номера </p>
<p> &nbsp; очереди, размеры окон, называется соединением. Каждое соединение </p>
<p> &nbsp; уникальным образом идентифицируется парой сокетов на двух концах. </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Если два процесса желают обмениваться информацией, соответству- </p>
<p> &nbsp; ющие программы протокола TCP должны сперва установить соединение </p>
<p> &nbsp; (на каждой стороне инициализировать информаицию о статусе). По за- </p>
<p> &nbsp; вершении обмена информацией соединение должно быть расторгнуто или </p>
<p> &nbsp; закрыто, чтобы освободить ресурсы для предоставления другим поль- </p>
<p> &nbsp; зователям. </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Поскольку соединения должны устанавливаться между ненадежными </p>
<p> &nbsp; хост-компьютерами и через ненадежную коммуникационную систему </p>
<p> &nbsp; Internet, то во избежание ошибочной инициализации соединений ис- </p>
<p> &nbsp; пользуется механизм подтверждения связи с хронометрированными но- </p>
<p> &nbsp; мерами очереди. </p>
<p>Приоритет и безопасность</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; Пользователи протокола TCP могут затребовать для своего соеди- </p>
<p> &nbsp; нения приоритет и безопасность. Предусмотрены принимаемые по умол- </p>
<p> &nbsp; чанию характеристики соединений, когда такие параметры не требуют- </p>
<p> &nbsp; ся.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. Идеология протокола &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.1 Элементы системы обединенных сетей &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Среда объединенных сетей состоит из хост-компьютеров, включенных в </p>
<p>сети, которые в свою очередь соединятся друг с другом через шлюзы. </p>
<p>Здесь предполагается, что компьютерные сети могут быть либо локальны- </p>
<p>ми (например, ETHERNET), либо большими сетями (например ARPANET), но </p>
<p>в любом случае они основываются на технологии коммутации пакетов. Ре- </p>
<p>альными агентами, создающими и потребляющими сообщения, циркулирующие </p>
<p>в сети, являются процессы. Протоколы различных уровней в сетях, на </p>
<p>шлюзах и на хост-компьютерах поддерживают систему коммуникаций между </p>
<p>процессами, которая обеспечивает двунаправленный поток данных по ло- </p>
<p>гическим соединениям между портами процессов.</p>
<p> &nbsp; Термин пакет используется здесь в общем случае для обозначения </p>
<p>порции данных, участвующей в отдельном элементарном акте взаимодей- </p>
<p>ствия между сетью и соединенным с ней хост-компьютером. В общем слу- </p>
<p>чае нас не будет касаться формат блоков данных, циркулирующих в сети.</p>
<p> &nbsp; С точки зрения коммуникационных сетей, хост-компьютеры - это ком- </p>
<p>пьютеры, связанные с сетью и являющиеся отправителями и получателями </p>
<p>пакетов. Процессы рассматриваются как активные элементы на хост- </p>
<p>компьютерах (согласно наболее общему определению процессов как испол- </p>
<p>няющихся программ). Предполагается, что даже терминалы, файлы и дру- </p>
<p>гие устройства ввода-вывода взаимодействуют друг с другом посредством </p>
<p>процессов. Таким образом, любые коммуникации рассматриваются как ком- </p>
<p>муникации между процессами.</p>
<p> &nbsp; Поскольку процесс может контролировать несколько коммуникационных </p>
<p>потоков, ведущих от него к другому процессу (или другим процессам), </p>
<p>то мы постулируем, что каждый процесс может иметь набор портов, через </p>
<p>которые он общается с портами других процессов. </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.2 Модель действия &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Процесс пересылает данные, вызывая программу протокола TCP и пере- </p>
<p>давая ей в качестве аргументов буферы с данными. Протокол TCP пакует </p>
<p>данные из этих буферов в сегменты, а затем вызывает модуль Internet </p>
<p>для передачи каждого сегмента на программу протокола TCP, являющуюся </p>
<p>адресатом. Этот адресат в свою очередь помещает данные из сегмента в </p>
<p>буферы получателя и затем оповещает свего клиента о прибытии предназ- </p>
<p>наченных ему данных. Программы протокола TCP помещают в сегменты кон- </p>
<p>трольную информацию, которая затем используется ими для проверки оче- </p>
<p>редности передачи данных. </p>
<p> &nbsp; Модель Internet коммуникаций состоит в том, что с каждой програм- </p>
<p>мой протокола TCP связан модуль протокола Internet, обеспечивающий ей </p>
<p>интерфейс с локальной сетью. Данный модуль Internet помещает сегменты </p>
<p>TCP в Internet датаграммы, а затем направляет их на другой Internet </p>
<p>модуль или же промежуточный шлюз. Для передачи датаграммы по локаль- </p>
<p>ной сети она в свою очередь помещается в пакет соответствующего типа.</p>
<p> &nbsp; Коммутаторы пакетов могут осуществлять дальнейшую упаковку, фраг- </p>
<p>ментацию или другие операции с тем, чтобы в локальной сети осущест- </p>
<p>вить передачу пакетов по назначению на модуль Internet. </p>
<p> &nbsp; На шлюзах между локальными сетями датаграмма Internet освобождает- </p>
<p>ся от пакета локальной сети и исследуется с тем, чтобы определить, по </p>
<p>какой сети она должна в дальнейшем идти. Затем Internet датаграмма </p>
<p>упаковывается в пакет, соответствующий выбранной локальной сети, и </p>
<p>посылается на следующий шлюз или же прямо к конечному получателю.</p>
<p> &nbsp; Шлюз имеет возможность разбивать Internet датаграмму на более мел- </p>
<p>кие датаграммы-фрагменты, если это необходимо для передачи по очеред- </p>
<p>ной локальной сети. Чтобы осуществить это, шлюз сам создает набор </p>
<p>Internet датаграмм, помещая в каждую по одному фрагменты. В дальней- </p>
<p>шем фрагменты могут быть снова разбиты следующими шлюзами на еще бо- </p>
<p>лее мелкие части. Формат фрагмента Internet датаграммы спроектирован </p>
<p>так, чтобы адресат - модуль Internet смог собрать фрагменты снова в </p>
<p>исходные Internet датаграммы.</p>
<p> &nbsp; Internet модуль, являющийся адресатом, выделяет сегмент из дата- </p>
<p>граммы (после ее сборки в случае необходимости) и затем передает его </p>
<p>по назначению на программу протокола TCP.</p>
<p> &nbsp; Данная простая модель действия протокола зачастую замалчивает мно- </p>
<p>жество деталей. Одной из важных характеристик является тип сервиса. </p>
<p>Этот признак дает указание шлюзу (или модулю Internet) о выборе пара- </p>
<p>метров сервиса, которые должны использоваться при передаче датаграммы </p>
<p>в очередной локальной сети. Приоритет датаграммы указывается среди </p>
<p>информации о типе сервиса. Датаграммы также могут нести информацию о </p>
<p>безопасности с тем, чтобы позволить хост-компьютерам и шлюзам, дей- </p>
<p>ствующим в многоуровневой системе безопасности, подвергать проверке </p>
<p>соотвествующие датаграммы.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.3 Программное обеспечение хост-компьютера &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Предполагается, что программа протокола TCP является модулем опе- </p>
<p>рационной системы. Клиенты обращаются к протоколу TCP в значительной </p>
<p>степени так же, как если бы они обращались к файловой системе. Сам </p>
<p>протокол TCP может обращаться к другим функциям операционной системы, </p>
<p>к примеру, для управления структурами данных. Предполагается, что </p>
<p>собственно интерфейс с локальной сетью осуществляется драйвером </p>
<p>устройства. Протокол TCP не обращается непосредственно к драйверам </p>
<p>сетевых устройств, а вместо этого делает вызов для модуля Internet </p>
<p>протокола, который в свою очередь и обращается к драйверу устройства.</p>
<p> &nbsp; Механизм протокола TCP не исключает его реализации на входном про- </p>
<p>цессоре. Однако, при такой реализации протокол общения между входными </p>
<p>процессорами должен обеспечивать средства для поддержки описанного в </p>
<p>этом документе интерфейса между пользователем и протоколом TCP. </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.4 Интерфейсы &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Для запросов со стороны пользователя к протоколу TCP интерфейс </p>
<p>TCP/пользователь обеспечивает открытие и закрытие соединения, посылку </p>
<p>и получение данных или же получение статуса соединения. Эти запросы </p>
<p>похожи на другие запросы программы пользователя к операционной систе- </p>
<p>ме, например, на запросы открытия, чтения и закрытия файла.</p>
<p> &nbsp; Интерфейс между протоколами TCP и Internet поддерживает запросы на </p>
<p>посылку и получение датаграмм, адресованных на модули TCP в хост- </p>
<p>компьютерах в любом месте сети Internet. Рассматриваемые запросы име- </p>
<p>ют аргументы для указания адреса, типа сервиса, приоритета, безопас- </p>
<p>ности, а также передачи другой правляющей информации. </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.5 Связь с другими протоколами &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Нижеприведенная диаграмма иллюстрирует место протокола TCP в </p>
<p>иерархии протоколов</p>
<p>+------+ +-----+ +-----+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-----+</p>
<p>|Telnet| | FTP | |Voice|&nbsp; ...&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Уровень приложений</p>
<p>+------+ +-----+ +-----+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-----+</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p>
<p> &nbsp;&nbsp;&nbsp; +-----+&nbsp;&nbsp;&nbsp;&nbsp; +-----+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-----+</p>
<p> &nbsp;&nbsp;&nbsp; | TCP |&nbsp;&nbsp;&nbsp;&nbsp; | RTP |&nbsp; ...&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Уровень хостов</p>
<p> &nbsp;&nbsp;&nbsp; +-----+&nbsp;&nbsp;&nbsp;&nbsp; +-----+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-----+</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; +------------------------------+</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; Internet протокол и ICMP&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; Уровень шлюзов</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; +------------------------------+</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; +------------------------------+</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; протокол локальной сети &nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; Сетевой уровень</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp; +------------------------------+</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Рис.2 Взаимосвязь протоколов</p>
<p>Предполагается, что протокол TCP будет в состоянии эффективно поддер- </p>
<p>живать протоколы более высокого уровня. Протокол TCP должен легко </p>
<p>взаимодействовать с такими протоколами более высокого уровня, как </p>
<p>ARPANET Telnet или AUDIN II THP to the TCP.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.6 Надежные коммуникации &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Поток данных, посылаемый на TCP соединение, принимается получате- </p>
<p>лем надежно и в соответствующей очередности. </p>
<p> &nbsp; Передача осуществляется надежно благодаря использованию подтвер- </p>
<p>ждений и номеров очереди. Концептуально каждому октету данных присва- </p>
<p>ивается номер очереди. Номер очереди для первого октета данных в сег- </p>
<p>менте передается вместе с этим сегментом и называется номером очереди </p>
<p>для сегмента. Сегменты также несут номер подтверждения, который явля- </p>
<p>ется номером для следующего ожидаемого октета данных, передаваемого в </p>
<p>обратном направлении. Когда протокол TCP передает сегмент с данными, </p>
<p>он помещает его копию в очередь повторной передачи и запускает тай- </p>
<p>мер. Когда приходит подтверждение для этих данных, соответствующий </p>
<p>сегмент удаляется из очереди. Если подтверждение не приходит до исте- </p>
<p>чения срока, то сегмент посылается повторно. </p>
<p> &nbsp; Подтверждение протокола TCP не гарантирует, что данные достигли </p>
<p>конечного получателя, а только то, что программа протокола TCP на </p>
<p>компьютере у получателя берет на себя ответственность за это. </p>
<p> &nbsp; Для направления потока данных между программами протоколов TCP </p>
<p>используется механизм управления потоками. Получающая программа прото- </p>
<p>кола TCP сообщает "окно" посылающей программе. Данное окно указывает </p>
<p>количество октетов (начиная с номера подтверждения), которое принима- </p>
<p>ющая программа TCP готова в настоящий момент принять. </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.7 Установка соединения и его отмена &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Чтобы идентифицировать отдельные потоки данных, поддерживаемые </p>
<p>протоколом TCP, последний определяет идентификаторы портов. Поскольку </p>
<p>идентификаторы портов выбираются каждой программой протокола TCP не- </p>
<p>зависимо, то они не будут уникальны. Чтобы обеспечить уникальность </p>
<p>адресов для каждой программы протокола TCP, мы объединяем идентифици- </p>
<p>рующий эту программу Internet адрес и идентификатор порта. В резуль- </p>
<p>тате получаем сокет, который будет уникален во всех локальных сетях, </p>
<p>объединенных в единое целое. </p>
<p> &nbsp; Соединение полностью определяется парой сокетов на своих концах. </p>
<p>Локальный сокет может принимать участие во многих соединениях с раз- </p>
<p>личными чужими сокетами. Соединение можно использовать для передачи </p>
<p>данных в обоих направлениях, иными словами, оно является "полностью </p>
<p>дуплексным". </p>
<p> &nbsp; Протокол TCP волен произвольным образом связывать порты с процес- </p>
<p>сами. Однако при любой реализации протокола необходимо придерживаться </p>
<p>нескольких основополагающих концепций. Должны присутствовать общеиз- </p>
<p>вестные сокеты, которые протокол TCP ассоциирует исключительно с </p>
<p>"соответствующими им" процессами. Мы представляем себе, как будто </p>
<p>процессы могут "владеть"портами и что процессы могут инициировать со- </p>
<p>единения только с тех портов, которыми они владеют. (С точки зрения </p>
<p>реализации протокола "владение" ограничивается хост-компьютером, од- </p>
<p>нако мы можем представить себе команду пользователя по запросу порта </p>
<p>(Request Port) или же метод выделения группы уникальных портов данно- </p>
<p>му процессу, например посредством ассоциирования старших байтов в </p>
<p>имени порта с данным процессом).</p>
<p> &nbsp; Соединение задается командой OPEN (открыть), сделанной с локально- </p>
<p>го порта и имеющей аргументом чужой сокет. В ответ на такой запрос </p>
<p>программа протокола TCP предоставляет имя локального (короткого) со- </p>
<p>единения. По этому имени пользователь адресуется к данному соединению </p>
<p>при последующих вызовах. О соединениях следует помнить кое-какие вещи. </p>
<p>Мы предполагаем, что имеется некая структура данных, называемая бло- </p>
<p>ком управления передачей (Transmission Control Block -TCB), предназ- </p>
<p>наченная для сохранения описанной выше информации. Можно было бы ре- </p>
<p>ализовать протокол таким образом, чтобы локальное имя для соединения </p>
<p>было бы указателем на структуру TCB последнего. Запрос OPEN указывает </p>
<p>также, осуществляется ли соединение активным образом, или же происхо- </p>
<p>дит пассивное ожидание соединения извне.</p>
<p> &nbsp; Запрос на пассивное открытие соединения означает, что процесс ждет </p>
<p>получения извне запросов на соединение, вместо того, чтобы пытаться </p>
<p>самому установить его. Часто процесс, сделавший запрос на пассивное </p>
<p>открытие, будет принимать запросы на соединение от любого другого </p>
<p>процесса. В этом случае чужой сокет указывается как состоящий целиком </p>
<p>из нулей, что означает неопределенность. Неопределенные чужие сокеты </p>
<p>могут присутствовать лишь в командах пассивного открытия.</p>
<p> &nbsp; Сервисный процесс, желающий обслужить другие, неизвестные ему про- </p>
<p>цессы, мог бы осуществить запрос на пассивное открытие с указанием </p>
<p>неопределенного сокета. В этом случае соединение может быть установ- </p>
<p>лено с любым процессом, запросившим соединения с этим локальным соке- </p>
<p>том. Такая процедура будет полезна, если известно, что выбранный ло- </p>
<p>кальный сокет ассоциирован с определенным сервисом. </p>
<p> &nbsp; Общеизвестные сокеты представляют собой удобный механизм априорно- </p>
<p>го привязывания адреса сокета с каким-либо стандартным сервисом. На- </p>
<p>пример, процесс "сервер для программы Telnet" жестко связан с кон- </p>
<p>кретным сокетом. Другие сокеты могут быть зарезервированы за передат- </p>
<p>чиком файлов, Remote Job Entry, текстовым генератором, эхо-сервером, </p>
<p>а также Sink-процессами (последние три пункта связаны с обработкой </p>
<p>текстов). Адрес сокета может быть зарезервирован для доступа к проце- </p>
<p>дуре "просмотра", которая могла бы указывать сокет, через который </p>
<p>можно было бы получить новообразованные услуги. Концепция общеизвест- </p>
<p>ного сокета является частью TCP спецификации, однако собственно асо- </p>
<p>циирование сокетов с услугами выходит за рамки данного описания про- </p>
<p>токола (см. документ [4]).</p>
<p> &nbsp; Процессы могут осуществлять пассивные открытия соединений и ждать, </p>
<p>пока от других процессов придут соответсвующие завпросы на активное </p>
<p>открытие, а протокол TCP проинформирует их об установлении соедине- </p>
<p>ния. Два процесса, сделавшие друг другу одновременно запросы на ак- </p>
<p>тивное открытие, получат корректное соединение. Гибкость такого под- </p>
<p>хода становится критичной при поддержке распределенных вычислений, </p>
<p>когда компоненты системы взаимодействуют друг с другом асинхронным </p>
<p>образом.</p>
<p> &nbsp; Когда осуществляется подбор сокетов для локального запроса пассив- </p>
<p>ного открытия и чужого запроса на активное открытие, то принципиаль- </p>
<p>ное значение имеют два случая. В первом сслучае местное пассивное от- </p>
<p>крытие полностью определяет чужой сокет. При этом подбор должен осу- </p>
<p>ществляться очень аккуратно. Во втором случае во время местного пас- </p>
<p>сивного открытия чужой сокет не указывается. Тогда в принципе может </p>
<p>быть установлено соединение с любых чужих сокетов. Во всех остальных </p>
<p>случаях подбор сокетов имеет частичные ограничения.</p>
<p> &nbsp; Если на один и тот же местный сокет осуществлено несколько ждущих </p>
<p>пассивных запросов на открытие (записанных в блоки TCB), и осущест- </p>
<p>вляется извне активный запрос на открытие, то чужой активный сокет </p>
<p>будет связываться с тем блоком TCB, где было указание именно на этот </p>
<p>запросивший соединения сокет. И только если такого блока TCB не су- </p>
<p>ществует, выбор партнера осуществляется среди блоков TCB с неопреде- </p>
<p>ленным чужим сокетом.</p>
<p> &nbsp; Процедура установки соединения использует флаг управления синхро- </p>
<p>низацией (SYN) и трижды обменивается сообщениями. Такой обмен называ- </p>
<p>ется трехвариантным подтверждением [3]. </p>
<p> &nbsp; Соединение инициируется при встрече пришедшего сегмента, несущего </p>
<p>флаг синхронизации (SYN), и ждущей его записи в блоке TCB. И сегмент </p>
<p>и запись создаются пришедшими от пользователей запросами на открытие. </p>
<p>Соответствие местного и чужого сокетов устанавливается при инициали- </p>
<p>зации соединения. Соединение признается установленным, когда номера </p>
<p>очередей синхронизированы в обоих направлениях между сокетами.</p>
<p> &nbsp; Отмена соединения также включает обмен сегментами, несущими на </p>
<p>этот раз управляющий флаг FIN.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.8 Коммуникация данных &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Набор данных, передаваемых по соединению, можно рассматривать как </p>
<p>поток октетов. Пользователь, отправляющий данные, указывает при за- </p>
<p>просе по посылку, следует ли данные, отправляемые при этом запросе, </p>
<p>немедленно проталкивать через сеть к получателю. Указание осуществля- </p>
<p>ется установкой флага PUSH (проталкивание).</p>
<p> &nbsp; Программа протокола TCP может собирать данные, принимаемые от </p>
<p>пользователя, а затем передавать их в сеть по своему усмотрению в ви- </p>
<p>де сегментов. Если же выставлен запрос на проталкивание, то протокол </p>
<p>должен передать все неотправленные ранее данные. Когда программа про- </p>
<p>токола TCP, принимающая данные, сталкивается с флагом проталкивания, </p>
<p>ей не следует ожидать получения новых данных по сети до тех пор, пока </p>
<p>уже имеющиеся данные не будут переданы ждущему их местному процессу.</p>
<p> &nbsp; Нет нужды привязывать функции проталкивания к границам сегмента. </p>
<p>Данные, содержащиеся в каком-либо сегменте, могут быть результатом </p>
<p>одного или нескольких запросов на посылку. Или же один запрос может </p>
<p>породить несколько сегментов.</p>
<p> &nbsp; Целью функции проталкивания и флага PUSH является проталкивание </p>
<p>данных через сеть от отправителя к получателю. Функция не </p>
<p>осуществляет обработки самих данных.</p>
<p> &nbsp; Существует связь между функцией проталкивания и использованием </p>
<p>буферов данных в интерфейсе между пользователем и протоколом TCP. </p>
<p>Каждый раз, когда в буфер получателя приходят данные с флагом PUSH, </p>
<p>содержимое этого буфера передается пользователдю на обработку, даже </p>
<p>если буфер и не был заполнен. Если приходящие данные заполняют буфер </p>
<p>пользователя до того, как получена команда проталкивания, </p>
<p>пользователю отправляется блок данных, соответствующий размеру </p>
<p>буфера. Протокол TCP имеет также средства для сообщения получателю, </p>
<p>что с некоторого момента он имеет дело со срочными данными. Протокол </p>
<p>TCP не пытается определить, что именно пользователь делает со ждущими </p>
<p>обработки срочными данными. Однако обычно предполагается, что </p>
<p>получающий данные процесс будет предпринимать усилия для быстрой </p>
<p>обработки срочных данных.</p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.9 Приоритет и безопасность &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Протокол TCP использует тип сервиса и опцию безопасности протокола </p>
<p>Internet с тем, чтобы пользователям протокола TCP обеспечить приори- </p>
<p>тет и безопасность на каждом соединении. Не все модули протокола TCP </p>
<p>обязательно будут действовать в многоуровневой системе обеспечения </p>
<p>безопасности. Некоторые модули ограничиваются только обычными, неспе- </p>
<p>цифическими соединениями, другие ограничиваются лишь первым уровнем </p>
<p>безопасности и закрытости. Следовательно, некоторые реализации прото- </p>
<p>кола TCP и услуг для пользователей могут использовать лишь часть мно- </p>
<p>гоуровневой системы безопасности. </p>
<p> &nbsp; Модули TCP, действующие в многоуровневой системе безопасности, </p>
<p>должны адекватным образом выставлять в отсылаемых сегментах флаги </p>
<p>безопасности и приоритета. Такие модули TCP должны также позволять </p>
<p>своим клиентам или вышестоящим протоколам, таким как Telnet и THP, </p>
<p>указывать требуемый уровень безопасности, закрытости и приоритета для </p>
<p>устанавливаемых соединений. </p>
<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.10 Принцип устойчивости &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p> &nbsp; Все реализации протокола TCP будут следовать общему принципу </p>
<p>устойчивости: быть консервативным в своих действиях и предоставлять </p>
<p>свободу для других.</p>
</div>

<div id="footer">
<hr/>
<p>Материал из DRKB Library<br/>Разработка и поддержка &mdash; <a title="DRKB на GitHub" href="https://github.com/quadroid/drkb" target="_blank">Quadr0</a></p>
</div>
</div>
</body>
</html>
